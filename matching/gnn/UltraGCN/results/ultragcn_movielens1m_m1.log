###################### UltraGCN ######################
1. Loading Configuration...
load path = ./ml-1m_ii_constraint_mat object
load path = ./ml-1m_ii_neighbor_mat object
Load Configuration OK, show them below
Configuration:
{'embedding_dim': 128, 'ii_neighbor_num': 10, 'model_save_path': './ultragcn_ml-1m.pt', 'max_epoch': 2000, 'enable_tensorboard': True, 'initial_weight': 0.001, 'dataset': 'ml-1m', 'gpu': '2', 'device': device(type='cuda', index=2), 'lr': 0.001, 'batch_size': 1024, 'early_stop_epoch': 50, 'w1': 1e-07, 'w2': 1.0, 'w3': 1e-07, 'w4': 1.0, 'negative_num': 200, 'negative_weight': 200.0, 'gamma': 0.0001, 'lambda': 0.001, 'sampling_sift_pos': False, 'test_batch_size': 2048, 'topk': 20, 'user_num': 6022, 'item_num': 3043}
Total training batches = 778
The time for epoch 0 is: train time = 00: 00: 51, test time = 00: 00: 03
Loss = 20.85748, F1-score: 0.092476 	 Precision: 0.07704	 Recall: 0.11564	NDCG: 0.11646
The time for epoch 5 is: train time = 00: 00: 41, test time = 00: 00: 03
Loss = 17.42431, F1-score: 0.091260 	 Precision: 0.07614	 Recall: 0.11388	NDCG: 0.11565
The time for epoch 10 is: train time = 00: 00: 35, test time = 00: 00: 03
Loss = 17.75606, F1-score: 0.090910 	 Precision: 0.07566	 Recall: 0.11385	NDCG: 0.11437
The time for epoch 15 is: train time = 00: 00: 32, test time = 00: 00: 02
Loss = 17.32856, F1-score: 0.130713 	 Precision: 0.10886	 Recall: 0.16355	NDCG: 0.17062
The time for epoch 20 is: train time = 00: 00: 32, test time = 00: 00: 03
Loss = 16.80242, F1-score: 0.160063 	 Precision: 0.12951	 Recall: 0.20949	NDCG: 0.20897
The time for epoch 25 is: train time = 00: 00: 34, test time = 00: 00: 02
Loss = 17.19784, F1-score: 0.172226 	 Precision: 0.13794	 Recall: 0.22920	NDCG: 0.22648
The time for epoch 30 is: train time = 00: 00: 32, test time = 00: 00: 02
Loss = 17.53183, F1-score: 0.180870 	 Precision: 0.14337	 Recall: 0.24492	NDCG: 0.23700
The time for epoch 35 is: train time = 00: 00: 29, test time = 00: 00: 02
Loss = 16.31652, F1-score: 0.187046 	 Precision: 0.14788	 Recall: 0.25443	NDCG: 0.24562
The time for epoch 40 is: train time = 00: 00: 32, test time = 00: 00: 02
Loss = 16.35237, F1-score: 0.190537 	 Precision: 0.15022	 Recall: 0.26045	NDCG: 0.25038
The time for epoch 45 is: train time = 00: 00: 33, test time = 00: 00: 02
Loss = 16.79988, F1-score: 0.195032 	 Precision: 0.15325	 Recall: 0.26812	NDCG: 0.25601
The time for epoch 50 is: train time = 00: 00: 29, test time = 00: 00: 03
Loss = 16.75206, F1-score: 0.196124 	 Precision: 0.15416	 Recall: 0.26948	NDCG: 0.25764
The time for epoch 51 is: train time = 00: 00: 30, test time = 00: 00: 02
Loss = 16.31272, F1-score: 0.196607 	 Precision: 0.15421	 Recall: 0.27116	NDCG: 0.25859
The time for epoch 52 is: train time = 00: 00: 31, test time = 00: 00: 02
Loss = 17.38579, F1-score: 0.196686 	 Precision: 0.15426	 Recall: 0.27130	NDCG: 0.25926
The time for epoch 53 is: train time = 00: 00: 32, test time = 00: 00: 02
Loss = 16.97376, F1-score: 0.197706 	 Precision: 0.15510	 Recall: 0.27259	NDCG: 0.25985
The time for epoch 54 is: train time = 00: 00: 33, test time = 00: 00: 02
Loss = 16.45226, F1-score: 0.196543 	 Precision: 0.15417	 Recall: 0.27104	NDCG: 0.25946
The time for epoch 55 is: train time = 00: 00: 33, test time = 00: 00: 02
Loss = 17.17084, F1-score: 0.197187 	 Precision: 0.15488	 Recall: 0.27129	NDCG: 0.26009
The time for epoch 56 is: train time = 00: 00: 33, test time = 00: 00: 02
Loss = 17.31583, F1-score: 0.198122 	 Precision: 0.15521	 Recall: 0.27382	NDCG: 0.26101
The time for epoch 57 is: train time = 00: 00: 29, test time = 00: 00: 02
Loss = 16.76984, F1-score: 0.196678 	 Precision: 0.15412	 Recall: 0.27171	NDCG: 0.25934
The time for epoch 58 is: train time = 00: 00: 31, test time = 00: 00: 02
Loss = 17.00002, F1-score: 0.197343 	 Precision: 0.15474	 Recall: 0.27231	NDCG: 0.26100
The time for epoch 59 is: train time = 00: 00: 29, test time = 00: 00: 02
Loss = 17.03228, F1-score: 0.198103 	 Precision: 0.15523	 Recall: 0.27369	NDCG: 0.26087
The time for epoch 60 is: train time = 00: 00: 32, test time = 00: 00: 02
Loss = 16.35216, F1-score: 0.198551 	 Precision: 0.15581	 Recall: 0.27360	NDCG: 0.26157
The time for epoch 61 is: train time = 00: 00: 27, test time = 00: 00: 02
Loss = 17.18019, F1-score: 0.198244 	 Precision: 0.15553	 Recall: 0.27330	NDCG: 0.26067
The time for epoch 62 is: train time = 00: 00: 27, test time = 00: 00: 02
Loss = 16.42161, F1-score: 0.198242 	 Precision: 0.15522	 Recall: 0.27425	NDCG: 0.26115
The time for epoch 63 is: train time = 00: 00: 27, test time = 00: 00: 02
Loss = 17.01111, F1-score: 0.198318 	 Precision: 0.15534	 Recall: 0.27418	NDCG: 0.26186
The time for epoch 64 is: train time = 00: 00: 31, test time = 00: 00: 02
Loss = 16.93983, F1-score: 0.198862 	 Precision: 0.15587	 Recall: 0.27460	NDCG: 0.26218
The time for epoch 65 is: train time = 00: 00: 32, test time = 00: 00: 02
Loss = 16.66921, F1-score: 0.198770 	 Precision: 0.15565	 Recall: 0.27495	NDCG: 0.26106
The time for epoch 66 is: train time = 00: 00: 30, test time = 00: 00: 02
Loss = 16.64371, F1-score: 0.199585 	 Precision: 0.15648	 Recall: 0.27545	NDCG: 0.26298
The time for epoch 67 is: train time = 00: 00: 33, test time = 00: 00: 02
Loss = 16.70279, F1-score: 0.199375 	 Precision: 0.15617	 Recall: 0.27563	NDCG: 0.26224
The time for epoch 68 is: train time = 00: 00: 32, test time = 00: 00: 02
Loss = 16.02302, F1-score: 0.200188 	 Precision: 0.15660	 Recall: 0.27739	NDCG: 0.26243
The time for epoch 69 is: train time = 00: 00: 31, test time = 00: 00: 02
Loss = 16.88204, F1-score: 0.199137 	 Precision: 0.15609	 Recall: 0.27496	NDCG: 0.26248
The time for epoch 70 is: train time = 00: 00: 31, test time = 00: 00: 02
Loss = 16.42399, F1-score: 0.200008 	 Precision: 0.15668	 Recall: 0.27647	NDCG: 0.26305
The time for epoch 71 is: train time = 00: 00: 33, test time = 00: 00: 02
Loss = 17.68129, F1-score: 0.199131 	 Precision: 0.15607	 Recall: 0.27501	NDCG: 0.26226
The time for epoch 72 is: train time = 00: 00: 27, test time = 00: 00: 02
Loss = 16.47774, F1-score: 0.198946 	 Precision: 0.15568	 Recall: 0.27552	NDCG: 0.26216
The time for epoch 73 is: train time = 00: 00: 32, test time = 00: 00: 02
Loss = 17.13570, F1-score: 0.199253 	 Precision: 0.15594	 Recall: 0.27589	NDCG: 0.26233
The time for epoch 74 is: train time = 00: 00: 32, test time = 00: 00: 02
Loss = 17.18034, F1-score: 0.200288 	 Precision: 0.15692	 Recall: 0.27677	NDCG: 0.26372
The time for epoch 75 is: train time = 00: 00: 32, test time = 00: 00: 02
Loss = 16.96045, F1-score: 0.200418 	 Precision: 0.15720	 Recall: 0.27641	NDCG: 0.26340
The time for epoch 76 is: train time = 00: 00: 28, test time = 00: 00: 02
Loss = 16.51641, F1-score: 0.200065 	 Precision: 0.15656	 Recall: 0.27705	NDCG: 0.26226
The time for epoch 77 is: train time = 00: 00: 35, test time = 00: 00: 02
Loss = 16.32395, F1-score: 0.200512 	 Precision: 0.15701	 Recall: 0.27737	NDCG: 0.26334
The time for epoch 78 is: train time = 00: 00: 31, test time = 00: 00: 02
Loss = 16.78148, F1-score: 0.200660 	 Precision: 0.15692	 Recall: 0.27819	NDCG: 0.26370
The time for epoch 79 is: train time = 00: 00: 31, test time = 00: 00: 02
Loss = 16.80712, F1-score: 0.200521 	 Precision: 0.15689	 Recall: 0.27776	NDCG: 0.26417
The time for epoch 80 is: train time = 00: 00: 31, test time = 00: 00: 02
Loss = 16.50187, F1-score: 0.200518 	 Precision: 0.15697	 Recall: 0.27752	NDCG: 0.26492
The time for epoch 81 is: train time = 00: 00: 31, test time = 00: 00: 03
Loss = 17.18743, F1-score: 0.200128 	 Precision: 0.15650	 Recall: 0.27748	NDCG: 0.26325
The time for epoch 82 is: train time = 00: 00: 35, test time = 00: 00: 03
Loss = 17.20703, F1-score: 0.200074 	 Precision: 0.15686	 Recall: 0.27616	NDCG: 0.26353
The time for epoch 83 is: train time = 00: 00: 33, test time = 00: 00: 02
Loss = 16.58676, F1-score: 0.200499 	 Precision: 0.15705	 Recall: 0.27719	NDCG: 0.26367
The time for epoch 84 is: train time = 00: 00: 32, test time = 00: 00: 02
Loss = 16.58913, F1-score: 0.199488 	 Precision: 0.15617	 Recall: 0.27606	NDCG: 0.26315
The time for epoch 85 is: train time = 00: 00: 31, test time = 00: 00: 02
Loss = 16.81643, F1-score: 0.199433 	 Precision: 0.15608	 Recall: 0.27614	NDCG: 0.26212
The time for epoch 86 is: train time = 00: 00: 31, test time = 00: 00: 02
Loss = 16.30840, F1-score: 0.200791 	 Precision: 0.15693	 Recall: 0.27867	NDCG: 0.26421
The time for epoch 87 is: train time = 00: 00: 28, test time = 00: 00: 02
Loss = 17.08791, F1-score: 0.200226 	 Precision: 0.15653	 Recall: 0.27775	NDCG: 0.26359
The time for epoch 88 is: train time = 00: 00: 21, test time = 00: 00: 01
Loss = 16.98640, F1-score: 0.199860 	 Precision: 0.15642	 Recall: 0.27671	NDCG: 0.26355
The time for epoch 89 is: train time = 00: 00: 18, test time = 00: 00: 01
Loss = 16.61094, F1-score: 0.199799 	 Precision: 0.15624	 Recall: 0.27705	NDCG: 0.26230
The time for epoch 90 is: train time = 00: 00: 17, test time = 00: 00: 01
Loss = 16.96062, F1-score: 0.200745 	 Precision: 0.15715	 Recall: 0.27782	NDCG: 0.26399
The time for epoch 91 is: train time = 00: 00: 18, test time = 00: 00: 01
Loss = 17.31312, F1-score: 0.200185 	 Precision: 0.15658	 Recall: 0.27744	NDCG: 0.26302
The time for epoch 92 is: train time = 00: 00: 19, test time = 00: 00: 01
Loss = 16.47269, F1-score: 0.200296 	 Precision: 0.15675	 Recall: 0.27734	NDCG: 0.26346
The time for epoch 93 is: train time = 00: 00: 18, test time = 00: 00: 01
Loss = 16.71171, F1-score: 0.199843 	 Precision: 0.15621	 Recall: 0.27730	NDCG: 0.26235
The time for epoch 94 is: train time = 00: 00: 17, test time = 00: 00: 01
Loss = 17.15456, F1-score: 0.199479 	 Precision: 0.15616	 Recall: 0.27605	NDCG: 0.26260
The time for epoch 95 is: train time = 00: 00: 17, test time = 00: 00: 01
Loss = 17.02725, F1-score: 0.199946 	 Precision: 0.15638	 Recall: 0.27717	NDCG: 0.26228
The time for epoch 96 is: train time = 00: 00: 16, test time = 00: 00: 01
Loss = 16.78905, F1-score: 0.199924 	 Precision: 0.15643	 Recall: 0.27693	NDCG: 0.26273
The time for epoch 97 is: train time = 00: 00: 17, test time = 00: 00: 02
Loss = 16.10626, F1-score: 0.200101 	 Precision: 0.15646	 Recall: 0.27751	NDCG: 0.26302
The time for epoch 98 is: train time = 00: 00: 18, test time = 00: 00: 01
Loss = 16.91861, F1-score: 0.200050 	 Precision: 0.15645	 Recall: 0.27734	NDCG: 0.26289
The time for epoch 99 is: train time = 00: 00: 20, test time = 00: 00: 02
Loss = 17.24595, F1-score: 0.199252 	 Precision: 0.15594	 Recall: 0.27589	NDCG: 0.26209
The time for epoch 100 is: train time = 00: 00: 21, test time = 00: 00: 01
Loss = 16.65431, F1-score: 0.199119 	 Precision: 0.15577	 Recall: 0.27590	NDCG: 0.26147
The time for epoch 101 is: train time = 00: 00: 19, test time = 00: 00: 01
Loss = 17.47581, F1-score: 0.199373 	 Precision: 0.15603	 Recall: 0.27607	NDCG: 0.26206
The time for epoch 102 is: train time = 00: 00: 21, test time = 00: 00: 01
Loss = 16.82619, F1-score: 0.198889 	 Precision: 0.15561	 Recall: 0.27551	NDCG: 0.26109
The time for epoch 103 is: train time = 00: 00: 18, test time = 00: 00: 02
Loss = 16.85231, F1-score: 0.199261 	 Precision: 0.15607	 Recall: 0.27551	NDCG: 0.26182
The time for epoch 104 is: train time = 00: 00: 19, test time = 00: 00: 01
Loss = 16.91778, F1-score: 0.199900 	 Precision: 0.15624	 Recall: 0.27741	NDCG: 0.26195
The time for epoch 105 is: train time = 00: 00: 19, test time = 00: 00: 01
Loss = 17.54634, F1-score: 0.199839 	 Precision: 0.15636	 Recall: 0.27681	NDCG: 0.26265
The time for epoch 106 is: train time = 00: 00: 21, test time = 00: 00: 01
Loss = 17.25303, F1-score: 0.198515 	 Precision: 0.15549	 Recall: 0.27446	NDCG: 0.26078
The time for epoch 107 is: train time = 00: 00: 19, test time = 00: 00: 01
Loss = 16.67087, F1-score: 0.199255 	 Precision: 0.15584	 Recall: 0.27621	NDCG: 0.26104
The time for epoch 108 is: train time = 00: 00: 22, test time = 00: 00: 01
Loss = 16.48401, F1-score: 0.199522 	 Precision: 0.15599	 Recall: 0.27677	NDCG: 0.26244
The time for epoch 109 is: train time = 00: 00: 18, test time = 00: 00: 02
Loss = 16.71455, F1-score: 0.198917 	 Precision: 0.15551	 Recall: 0.27593	NDCG: 0.26209
The time for epoch 110 is: train time = 00: 00: 19, test time = 00: 00: 01
Loss = 16.44915, F1-score: 0.199147 	 Precision: 0.15578	 Recall: 0.27598	NDCG: 0.26133
The time for epoch 111 is: train time = 00: 00: 20, test time = 00: 00: 01
Loss = 17.08844, F1-score: 0.199443 	 Precision: 0.15611	 Recall: 0.27607	NDCG: 0.26197
The time for epoch 112 is: train time = 00: 00: 20, test time = 00: 00: 01
Loss = 16.64709, F1-score: 0.198824 	 Precision: 0.15535	 Recall: 0.27609	NDCG: 0.26143
The time for epoch 113 is: train time = 00: 00: 21, test time = 00: 00: 01
Loss = 16.90265, F1-score: 0.199117 	 Precision: 0.15574	 Recall: 0.27599	NDCG: 0.26212
The time for epoch 114 is: train time = 00: 00: 18, test time = 00: 00: 02
Loss = 17.28700, F1-score: 0.199425 	 Precision: 0.15610	 Recall: 0.27603	NDCG: 0.26289
The time for epoch 115 is: train time = 00: 00: 20, test time = 00: 00: 02
Loss = 17.29214, F1-score: 0.198548 	 Precision: 0.15528	 Recall: 0.27524	NDCG: 0.26012
The time for epoch 116 is: train time = 00: 00: 19, test time = 00: 00: 01
Loss = 16.46904, F1-score: 0.199058 	 Precision: 0.15559	 Recall: 0.27624	NDCG: 0.26173
The time for epoch 117 is: train time = 00: 00: 20, test time = 00: 00: 01
Loss = 17.11951, F1-score: 0.199272 	 Precision: 0.15586	 Recall: 0.27620	NDCG: 0.26197
The time for epoch 118 is: train time = 00: 00: 17, test time = 00: 00: 01
Loss = 17.12451, F1-score: 0.199220 	 Precision: 0.15584	 Recall: 0.27608	NDCG: 0.26118
The time for epoch 119 is: train time = 00: 00: 17, test time = 00: 00: 01
Loss = 17.27514, F1-score: 0.198554 	 Precision: 0.15526	 Recall: 0.27532	NDCG: 0.26065
The time for epoch 120 is: train time = 00: 00: 18, test time = 00: 00: 01
Loss = 16.77202, F1-score: 0.197822 	 Precision: 0.15477	 Recall: 0.27407	NDCG: 0.25969
The time for epoch 121 is: train time = 00: 00: 20, test time = 00: 00: 01
Loss = 17.18069, F1-score: 0.199732 	 Precision: 0.15627	 Recall: 0.27669	NDCG: 0.26187
The time for epoch 122 is: train time = 00: 00: 22, test time = 00: 00: 02
Loss = 16.86820, F1-score: 0.198763 	 Precision: 0.15522	 Recall: 0.27625	NDCG: 0.26146
The time for epoch 123 is: train time = 00: 00: 20, test time = 00: 00: 01
Loss = 17.08891, F1-score: 0.198694 	 Precision: 0.15559	 Recall: 0.27484	NDCG: 0.26104
The time for epoch 124 is: train time = 00: 00: 17, test time = 00: 00: 01
Loss = 17.06976, F1-score: 0.197447 	 Precision: 0.15419	 Recall: 0.27443	NDCG: 0.26036
The time for epoch 125 is: train time = 00: 00: 18, test time = 00: 00: 01
Loss = 17.16300, F1-score: 0.198616 	 Precision: 0.15521	 Recall: 0.27571	NDCG: 0.26069
The time for epoch 126 is: train time = 00: 00: 18, test time = 00: 00: 01
Loss = 17.03064, F1-score: 0.198421 	 Precision: 0.15522	 Recall: 0.27494	NDCG: 0.26089
The time for epoch 127 is: train time = 00: 00: 19, test time = 00: 00: 01
Loss = 17.49223, F1-score: 0.199067 	 Precision: 0.15567	 Recall: 0.27601	NDCG: 0.26101
The time for epoch 128 is: train time = 00: 00: 17, test time = 00: 00: 01
Loss = 17.39763, F1-score: 0.199294 	 Precision: 0.15568	 Recall: 0.27686	NDCG: 0.26149
The time for epoch 129 is: train time = 00: 00: 18, test time = 00: 00: 01
Loss = 17.08009, F1-score: 0.198459 	 Precision: 0.15526	 Recall: 0.27495	NDCG: 0.26135
The time for epoch 130 is: train time = 00: 00: 17, test time = 00: 00: 01
Loss = 17.46577, F1-score: 0.198918 	 Precision: 0.15557	 Recall: 0.27575	NDCG: 0.26127
The time for epoch 131 is: train time = 00: 00: 19, test time = 00: 00: 01
Loss = 17.11398, F1-score: 0.197863 	 Precision: 0.15483	 Recall: 0.27402	NDCG: 0.26026
The time for epoch 132 is: train time = 00: 00: 18, test time = 00: 00: 01
Loss = 16.39162, F1-score: 0.197784 	 Precision: 0.15469	 Recall: 0.27416	NDCG: 0.26017
The time for epoch 133 is: train time = 00: 00: 20, test time = 00: 00: 01
Loss = 16.97149, F1-score: 0.198183 	 Precision: 0.15495	 Recall: 0.27488	NDCG: 0.26080
The time for epoch 134 is: train time = 00: 00: 19, test time = 00: 00: 01
Loss = 16.81237, F1-score: 0.198626 	 Precision: 0.15541	 Recall: 0.27515	NDCG: 0.26096
The time for epoch 135 is: train time = 00: 00: 19, test time = 00: 00: 02
Loss = 16.95040, F1-score: 0.197860 	 Precision: 0.15463	 Recall: 0.27463	NDCG: 0.26031
The time for epoch 136 is: train time = 00: 00: 19, test time = 00: 00: 01
Loss = 17.17835, F1-score: 0.198024 	 Precision: 0.15488	 Recall: 0.27448	NDCG: 0.26113
##########################################
Early stop is triggered at 136 epochs.
Results:
best epoch = 86, best recall = 0.278671208895094, best ndcg = 0.26421063460327485
The best model is saved at ./ultragcn_ml-1m.pt
Training end!
END